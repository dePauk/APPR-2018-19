---
title: "Poročilo pri predmetu Analiza podatkov s programom R"
author: "Darjan Pavšič"
output:
  html_document: default
  pdf_document:
    includes:
      in_header: lib/styles.sty
    latex_engine: xelatex
---

```{r setup, echo=FALSE, results='hide', message=FALSE, warning=FALSE}
# Če želimo nastaviti pisave v PDF-ju, odkomentiramo
# in sledimo navodilom v programu.
#source("fontconfig.r", encoding="UTF-8")

# Uvoz vseh potrebnih knjižnic
source("lib/libraries.r", encoding="UTF-8")
```

```{r rstudio, echo=FALSE, results='asis'}
# Izris povezave do RStudia na Binderju
source("lib/rstudio.r", encoding="UTF-8")
```

## Igralci tedna in uspešnost njihovih ekip v ligi NBA

V projektu bom analiziral igralce tedna ("Player of the Week") lige NBA v sezonah od 1984/85 do 2017/18. Poskušal bom ugotoviti, kako močna je korelacija med številom osvojenih nazivov igralca tedna posamezne ekipe in številom oziroma odstotkom dobljenih tekem teh ekip v istem obdobju. Poleg tega bom igralce, ki so bili izbrani kot najboljši v tednu, primerjal po poziciji igranja, starosti, višini, teži, številu let od debija v ligi ter po tem, katera je bila njihova pozicija na t.i. draftu. V letih, ko je bil naslov igralca tedna dodeljen le enemu igralcu, in ne po enemu igralcu iz posamezne konference, bom analiziral, katera konferenca je bila uspešnejša v številu teh nazivov in rezultat primerjal z uspešnostjo njihovih ekip v zaključni fazi tekmovanja.

***

# Obdelava, uvoz in čiščenje podatkov

```{r uvoz, echo=FALSE, message=FALSE}
source("uvoz/uvoz.r", encoding="UTF-8")
```

Uvozil sem podatke o igralcih tedna in sezonski statistiki igralcev v izbranih sezonah v obliki CSV s spletne strani Kaggle ter statistiko NBA ekip v tem obdobju s spletne strani mcubed.net in all-star igralce iz Wikipedije v obliki HTML. Podatki so v razpredelnicah v obliki *tidy data*.


1. 'podatki_ekipe_imensko'

  - `Ekipa` - imena ekip, urejena po abecednem vrstnem redu
  - `Zmage_redni_del` - spremenljivka: število zmag ekipe v izbranem obdobju
  - `Porazi_redni_del` - spremenljivka: število porazov ekipe v izbranem obdobju
  - `Uspesnost_redni_del` - spremenljivka: delež zmaganih tekem v rednem delu
  - `Stevilo_playoffov` - spremenljivka: število uvrstitev v končnico oziroma "Play-off"
  - `Playoff_zmage` - spremenljivka: število zmag v Play-offih
  - `Playoff_porazi` - spremenljivka: število porazov v Play-offih
  - `Zmage_serij` - spremenljivka: število premaganih nasprotnikov v Play-offih (uvrstitev v naslednji krog končnice)
  - `Porazi_serij` - spremenljivka: število izgubljenih serij (izpadov iz končnice)
  - `Uspesnost_serij` - spremenljivka: delež zmaganih serij
  - `Nastopi_finale` - spremenljivka: število nastopov v finalih (zmag svoje konference)
  - `Zmage_finale` - spremenljivka: število osvojenih nazivov zmagovalca lige
  - `Kratice` - okrajšano ime ekipe
  

2. 'igralci_tedna'

  - `Starost` - meritev: starost igralca
  - `Konferenca` - spremenljivka: vzhod/zahod
  - `Leto_drafta` - spremenljivka: leto, v katerem je bil igralec draftan v ligo
  - `Visina` - meritev: višina igralca
  - `Ime` - spremenljivka: ime igralca
  - `Pozicija` - spremenljivka: pozicija igranja
  - `Sezona okrajsano` - spremenljivka: za npr. sezono 1991/92 bo tukaj vrednost 1992
  - `Stevilo_sezon_v_ligi` - meritev: število odigranih sezon pred začetkom trenutne (v tej sezoni draftani igralci imajo torej vrednost 0)
  - `Igralceva_ekipa` - spremenljivka: ekipa, v kateri igra
  - `Vrednost_naziva` - spremenljivka: 0.5 za sezone, kjer se naziv dodeli po enemu igralcu iz vsake konference oz. 1 za sezone, kjer se naziv dodeli enemu igralcu iz celotne lige


3. 'stevilo_nazivov' - pridobljena iz tabele igralci_tedna

  - `Ekipa` - imena ekip, urejena po vrstnem redu
  - `Stevilo` - število dobljenih nazivov igralca tedna ekipe
  

4. 'statistika'

  - `Leto`
  - `Igralec`
  - `Pozicija`
  - `Starost`
  - `Ekipa`
  - `Stevilo_iger`
  - `Stevilo_zacetih_iger`
  - `Odigrane_minute`
  - `Player_efficiency_rating`
  - `True_shooting`
  - `Ft_rate`
  - `Odstotek_skoki_napad`
  - `Odstotek_skoki_obramba`
  - `Odstotek_asistenc`
  - `Ukradene_zoge`
  - `Blokirani_meti`
  - `Odstotek_izgubljenih_zog`
  

5. 'tabela_allstar'

  - `Igralec`
  - `Stevilo_allstar_nastopov`
  - `Sezone_allstar`







Spodnji graf prikazuje uspešnost ekip v rednem delu VS uspešnost ekip v Play-Offih. Velikost kroga pomeni število uvrstitev v Play-offe.

```{r grafvs, echo=FALSE, message=FALSE, fig.align='center', fig.cap='Uspešnost ekip v rednem delu VS uspešnost ekip v Play-Offih'}

ggplot(data=podatki_ekipe_imensko, aes(x=podatki_ekipe_imensko$Uspesnost_redni_del, y=podatki_ekipe_imensko$Playoff_uspesnost)) + 
  geom_jitter(size=(podatki_ekipe_imensko$Stevilo_playoffov)/1, shape=16, color="dodgerblue3") + geom_smooth() +
  ggtitle("Korelacija uspešnosti") + xlab("Uspešnost v rednem delu") + ylab("Uspešnost v Play-offih")
```




```{r grafvisina_pozicija, echo=FALSE, message=FALSE, fig.align='center', fig.cap='Višina igralcev glede na pozicijo igranja'}

ggplot(data=igralci_tedna, aes(x=igralci_tedna$Pozicija, y=igralci_tedna$Visina)) + geom_boxplot(alpha=I(0.8),fill="firebrick1",outlier.size = 0.3) + ggtitle("Višina glede na pozicijo igranja") + xlab("Pozicija igranja") + ylab("Višina igralcev")
```




```{r graf_nazivi_pozicija, echo=FALSE, message=FALSE, fig.align='center', fig.cap='Osvajanje nazivov igralca tedna glede na pozicijo skozi čas'}

ggplot(data=igralci_tedna_pozicijefilt, aes(x=igralci_tedna_pozicijefilt$Sezona_okrajsano)) + geom_histogram(binwidth=1) + facet_grid(~Pozicija) + ggtitle("Osvojeni nazivi igralca tedna glede na pozicijo igranja skozi čas") + xlab("Leto") + ylab("Število")
```



```{r graf_uspesnost_ekipe_igralci, echo=FALSE, message=FALSE, fig.align='center', fig.cap='Število zmag vs Število osvojenih nazivov igralca tedna po ekipah'}

ggplot(data=join_za_graf, aes(x=reorder(Kratice,desc(Zmage_redni_del+Playoff_zmage)), y=Stevilo, fill=Zmage_redni_del+Playoff_zmage)) + geom_col() + xlab("Ekipa") + ggtitle("Število zmag in število osvojenih nazivov igralca tedna po ekipah") + xlab("Ekipa") + ylab("Igralec tedna")
```


 

